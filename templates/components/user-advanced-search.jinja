<div class="dropdown dropdown-end">
  <label tabindex="0" class="btn btn-outline">
    <span class="material-icons-outlined mr-1">filter_alt</span>
    Filters
  </label>
  <div tabindex="0" class="dropdown-content z-[1] card card-compact w-96 p-2 shadow bg-base-100">
    <div class="card-body">
      <h3 class="card-title text-lg">Advanced User Search</h3>
      <form id="advanced-search-form" method="GET" action="{{ url('user-search') }}">
        <!-- Hidden field to preserve the main search query -->
        <input type="hidden" name="q" value="{{ search_str|default('') }}">
        
        <!-- User type filter -->
        <div class="form-control mb-2">
          <label class="label">
            <span class="label-text">User Type</span>
          </label>
          <select name="user_type" class="select select-bordered select-sm w-full">
            <option value="">All Users</option>
            <option value="student" {% if request.GET.user_type == 'student' %}selected{% endif %}>Students</option>
            <option value="faculty" {% if request.GET.user_type == 'faculty' %}selected{% endif %}>Faculty</option>
            <option value="staff" {% if request.GET.user_type == 'staff' %}selected{% endif %}>Staff</option>
          </select>
        </div>
        
        <!-- Department/Major filter -->
        <div class="form-control mb-2">
          <label class="label">
            <span class="label-text">Department/Major</span>
          </label>
          <input type="text" name="department" placeholder="e.g. Computer Science" class="input input-bordered input-sm w-full" value="{{ request.GET.department|default('') }}">
        </div>
        
        <!-- Year filter -->
        <div class="form-control mb-2">
          <label class="label">
            <span class="label-text">Year</span>
          </label>
          <select name="year" class="select select-bordered select-sm w-full">
            <option value="">Any Year</option>
            <option value="freshman" {% if request.GET.year == 'freshman' %}selected{% endif %}>Freshman</option>
            <option value="sophomore" {% if request.GET.year == 'sophomore' %}selected{% endif %}>Sophomore</option>
            <option value="junior" {% if request.GET.year == 'junior' %}selected{% endif %}>Junior</option>
            <option value="senior" {% if request.GET.year == 'senior' %}selected{% endif %}>Senior</option>
            <option value="graduate" {% if request.GET.year == 'graduate' %}selected{% endif %}>Graduate</option>
          </select>
        </div>
        
        <!-- Activity filter -->
        <div class="form-control mb-2">
          <label class="label">
            <span class="label-text">Activity</span>
          </label>
          <select name="activity" class="select select-bordered select-sm w-full">
            <option value="">Any Activity Level</option>
            <option value="very_active" {% if request.GET.activity == 'very_active' %}selected{% endif %}>Very Active</option>
            <option value="active" {% if request.GET.activity == 'active' %}selected{% endif %}>Active</option>
            <option value="somewhat_active" {% if request.GET.activity == 'somewhat_active' %}selected{% endif %}>Somewhat Active</option>
            <option value="inactive" {% if request.GET.activity == 'inactive' %}selected{% endif %}>Inactive</option>
          </select>
        </div>
        
        <!-- Sort options -->
        <div class="form-control mb-2">
          <label class="label">
            <span class="label-text">Sort By</span>
          </label>
          <select name="sort" class="select select-bordered select-sm w-full">
            <option value="name_asc" {% if request.GET.sort == 'name_asc' %}selected{% endif %}>Name (A-Z)</option>
            <option value="name_desc" {% if request.GET.sort == 'name_desc' %}selected{% endif %}>Name (Z-A)</option>
            <option value="newest" {% if request.GET.sort == 'newest' or not request.GET.sort %}selected{% endif %}>Newest Members</option>
            <option value="oldest" {% if request.GET.sort == 'oldest' %}selected{% endif %}>Oldest Members</option>
            <option value="most_posts" {% if request.GET.sort == 'most_posts' %}selected{% endif %}>Most Posts</option>
            <option value="most_followers" {% if request.GET.sort == 'most_followers' %}selected{% endif %}>Most Followers</option>
          </select>
        </div>
        
        <!-- Form actions -->
        <div class="flex justify-between mt-4">
          <a href="{{ url('user-search') }}" class="btn btn-sm btn-ghost">Reset</a>
          <button type="submit" class="btn btn-sm btn-primary">Apply Filters</button>
        </div>
      </form>
    </div>
  </div>
</div> 