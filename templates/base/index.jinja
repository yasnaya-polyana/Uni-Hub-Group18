<!DOCTYPE html>
<html lang="en" data-theme="cupcake">
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>UniHub - {% block title %}{% endblock %}</title>
      <link
        href="https://cdn.jsdelivr.net/npm/daisyui@3.7.3/dist/full.css"
        rel="stylesheet"
        type="text/css"
      />
      <link
        href="https://fonts.googleapis.com/icon?family=Material+Icons"
        rel="stylesheet"
      />
      <link
        href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"
        rel="stylesheet"
      />
      <script src="https://cdn.tailwindcss.com"></script>
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      
      <script>
        // Apply theme immediately to prevent flash of wrong theme
        (function() {
          // Get saved theme from localStorage or use default
          const savedTheme = localStorage.getItem('theme') || 'cupcake';
          
          // Apply theme to html element immediately
          document.documentElement.setAttribute('data-theme', savedTheme);
        })();
      </script>

      <!-- Markdown Editor -->
      <link
        href="{{ static('simplemde/simplemde.css') }}"
        rel="stylesheet"
      />
      <script src="{{ static('simplemde/simplemde.min.js') }}"></script>
    </head>
    <body class="h-[100vh]">
        {% include 'base/nav.jinja' %}
        <main class="container mx-auto px-4 py-8 h-[95%]">
          {% if messages %}
            {% for message in messages %}<div class="alert alert-{{ message.tags }} mb-4">{{ message }}</div>{% endfor %}
          {% endif %}
          {% block content %}{% endblock %}
        </main>
        <div role="alert"
             id="alert-box"
             class="absolute bottom-2 w-[90%] left-[5%] z-100"></div>
    </body>
    
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Get the toggle element
        const themeToggle = document.getElementById('theme-toggle');
        
        if (themeToggle) {
          // Get saved theme from localStorage or use default
          const savedTheme = localStorage.getItem('theme') || 'cupcake';
          
          // Set the toggle state based on the saved theme
          themeToggle.checked = savedTheme === 'dark';
          
          // Add event listener for toggle changes
          themeToggle.addEventListener('change', function() {
            const newTheme = this.checked ? 'dark' : 'cupcake';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            console.log('Theme changed to:', newTheme);
          });
        }
      });
    </script>
    
    {% include "base/logic.jinja" %}
</html>
